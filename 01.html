<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µë¶€ì ê°€ì´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Stone & Amber (Warm, Traditional, Calm) -->
    <!-- Application Structure Plan: 
         1. Dashboard Header: Introduction.
         2. Interactive Timeline: 3-Phase Stepper.
         3. Dynamic Content Area: Cards for tasks + Dropdowns for Phase 3.
         4. Formation Simulator: Visual grid for Bongsim alignment (Sinwi on Top & Right).
         5. Role Filter: REMOVED.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f5f5f4; /* stone-100 */
        }
        h1, h2, h3, .serif {
            font-family: 'Noto Serif KR', serif;
        }
        .step-card {
            transition: all 0.3s ease;
        }
        .step-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .formation-node {
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); /* Slower, Bouncy transition */
        }
        /* Dropdown/Details styling */
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details[open] summary ~ * {
            animation: sweep .3s ease-in-out;
        }
        @keyframes sweep {
            0%    {opacity: 0; transform: translateY(-10px)}
            100%  {opacity: 1; transform: translateY(0)}
        }
        /* Vertical Text for Sinwi */
        .writing-vertical {
            writing-mode: vertical-rl;
            text-orientation: upright;
        }
    </style>
</head>
<body class="text-stone-800 antialiased selection:bg-amber-200 selection:text-amber-900 text-lg">

    <!-- Navigation / Header -->
    <nav class="bg-stone-900 text-stone-100 shadow-lg sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold serif tracking-wider">ê³µë¶€ì ê°€ì´ë“œ</span>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="hidden md:block">
                        <span id="current-time-display" class="text-amber-400 font-mono text-base">20:00 ì…ì†Œ ì‹œì‘</span>
                    </div>
                    <!-- Home Button -->
                    <a href="index.html" class="flex items-center px-4 py-2 bg-stone-700 hover:bg-stone-600 rounded-md transition-colors duration-200 border border-stone-600">
                        <span class="mr-2 text-xl">ğŸ </span>
                        <span class="text-base font-bold">í™ˆìœ¼ë¡œ</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Intro Section (Chart Removed) -->
        <div class="mb-12">
            <div class="bg-white rounded-xl shadow-sm p-8 border-l-4 border-amber-600">
                <h1 class="text-4xl font-bold text-stone-900 mb-6">ì…ì†Œ ë° ì¤€ë¹„ ê³¼ì • ì•ˆë‚´</h1>
                <p class="text-xl text-stone-600 leading-relaxed mb-8">
                    ë³¸ ê°€ì´ë“œëŠ” ë³¸ë¶€ ë„ì°©ë¶€í„° ì²« ê³µì‹ ì˜ì‹ì¸ <strong>'ë“œëŠ” ë´‰ì‹¬'</strong>ê¹Œì§€ì˜ ê³¼ì •ì„ ì•ˆë‚´í•©ë‹ˆë‹¤. 
                    ê²½ê±´í•œ ë§ˆìŒìœ¼ë¡œ ìˆ˜ë ¨ì— ì„í•  ìˆ˜ ìˆë„ë¡ ì‹œê°„ëŒ€ë³„ ì ˆì°¨ì™€ í•µì‹¬ ì˜ˆë²•ì„ ìˆ™ì§€í•´ ì£¼ì‹­ì‹œì˜¤.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-stone-100 px-6 py-4 rounded-lg border border-stone-200">
                        <span class="block text-sm text-stone-500 font-bold uppercase mb-2">ê¸°ë³¸ ì¤€ë¹„ë¬¼</span>
                        <span class="font-medium text-lg">í•œë³µ, ê°œì¸ ì„¸ë©´ë„êµ¬</span>
                    </div>
                    <div class="bg-stone-100 px-6 py-4 rounded-lg border border-stone-200">
                        <span class="block text-sm text-stone-500 font-bold uppercase mb-2">ì¶”ê°€ ì¤€ë¹„ë¬¼</span>
                        <span class="font-medium text-lg">í¸í•œ ì¼ìƒë³µ(ì²­ì†Œìš©), ê°œì¸ ì»µ(í…€ë¸”ëŸ¬), ê°œì¸ ìƒë¹„ì•½, ê¸°íƒ€ ì†Œì§€í’ˆ</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Timeline Controls -->
        <div class="mb-10">
            <div class="flex flex-col sm:flex-row justify-between items-center bg-stone-200 p-2 rounded-xl gap-2 sm:gap-0">
                <button onclick="setPhase(0)" id="btn-phase-0" class="flex-1 w-full text-center py-4 rounded-lg text-base font-bold transition-all duration-200 bg-white shadow-sm text-stone-900">
                    ë„ì°© ë° ì¤€ë¹„
                    <span class="block text-sm font-normal text-stone-500 mt-1">20:00 ~ 21:20</span>
                </button>
                <button onclick="setPhase(1)" id="btn-phase-1" class="flex-1 w-full text-center py-4 rounded-lg text-base font-bold text-stone-500 hover:bg-stone-100 hover:text-stone-700 transition-all duration-200">
                    ì í˜¸
                    <span class="block text-sm font-normal text-stone-400 mt-1">21:20 ~ 22:20</span>
                </button>
                <button onclick="setPhase(2)" id="btn-phase-2" class="flex-1 w-full text-center py-4 rounded-lg text-base font-bold text-stone-500 hover:bg-stone-100 hover:text-stone-700 transition-all duration-200">
                    ë“œëŠ” ë´‰ì‹¬
                    <span class="block text-sm font-normal text-stone-400 mt-1">22:20 ~ ì¢…ë£Œ</span>
                </button>
            </div>
        </div>

        <!-- Dynamic Phase Content -->
        <div id="phase-content" class="min-h-[400px]">
            <!-- Content injected via JS -->
        </div>

    </main>

    <!-- Footer / Checklist -->
    <footer class="bg-stone-800 text-stone-300 py-12 mt-12">
        <div class="max-w-6xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <h3 class="serif text-2xl text-white mb-6">í•µì‹¬ ì¤€ìˆ˜ ì‚¬í•­ (Checklist)</h3>
                <ul class="space-y-4 text-base">
                    <li class="flex items-start">
                        <span class="text-amber-500 mr-3 text-xl">âœ“</span>
                        <span><strong>ì™¼ë°œ ì›ì¹™:</strong> ëŒ€ê°•ì „ ë“œë‚˜ë“¤ ë•Œ í•­ìƒ <strong>ì™¼ë°œ</strong> ë¨¼ì € ë‚´ë”›ìŠµë‹ˆë‹¤.</span>
                    </li>
                    <li class="flex items-start">
                        <span class="text-amber-500 mr-3 text-xl">âœ“</span>
                        <span><strong>êµ­ê¶ ìì„¸:</strong> ì´ë™ êµ¬ë ¹ ì‹œ í—ˆë¦¬ë¥¼ ìˆ™ì¸ ìì„¸ë¥¼ ëê¹Œì§€ ìœ ì§€í•©ë‹ˆë‹¤.</span>
                    </li>
                    <li class="flex items-start">
                        <span class="text-amber-500 mr-3 text-xl">âœ“</span>
                        <span><strong>ì •ìˆ™ ìœ ì§€:</strong> ëŒ€ê¸° ì¤‘ì—ëŠ” ì¡ë‹´ì„ ê¸ˆí•˜ê³  ë§ˆìŒì„ ëª¨ìë‹ˆë‹¤.</span>
                    </li>
                </ul>
            </div>
            <div>
                <div class="bg-stone-700 rounded-lg p-6">
                    <p class="text-sm text-stone-400 mb-3">ë„ì›€ë§</p>
                    <p class="text-lg leading-relaxed">
                        3ë‹¨ê³„ 'ë“œëŠ” ë´‰ì‹¬' íƒ­ì—ì„œëŠ” <strong>ì´ 36ëª…</strong>ì˜ ëŒ€í˜• ë³€í™” ì‹œë®¬ë ˆì´ì…˜ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                        ì˜¤ë¥¸ìª½ê³¼ ìƒë‹¨ì˜ 'ì‹ ìœ„' ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ì„ í™•ì¸í•˜ì„¸ìš”.
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- Data Definitions ---
        const phases = [
            {
                id: 0,
                title: "ë„ì°© ë° ì¤€ë¹„",
                timeRange: "20:00 ~ 21:20",
                description: "ê³µë¶€ ì‹œì‘ ì „ë‚  ì €ë…, ë³¸ë¶€ì— ë„ì°©í•˜ì—¬ í–‰ì • ì ˆì°¨ë¥¼ ë§ˆì¹˜ê³  ëª¸ê³¼ ë§ˆìŒì„ ì •ëˆí•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.",
                steps: [
                    { time: "20:00 ì´ì „", title: "ë³¸ë¶€ ë„ì°© ë° êµ­ê¶", desc: "ë„ì°© ì¦‰ì‹œ ëŒ€ê°•ì „ì— ë“¤ëŸ¬ ì¸ì‚¬ë¥¼ ë“œë¦¬ê³ , ì •ê¸‰ì‹¤ì—ì„œ ìˆ™ì†Œë¥¼ ë°°ì •ë°›ìŠµë‹ˆë‹¤.", role: "all" },
                    { time: "20:10", title: "í™˜ë³µ", desc: "ìˆ™ì†Œì— ì§ì„ í’€ê³  ì •ê°ˆí•œ í•œë³µìœ¼ë¡œ ê°ˆì•„ì…ìŠµë‹ˆë‹¤.", role: "all" },
                    { time: "20:30", title: "ê³µì§€ì‚¬í•­ ì²­ì·¨", desc: "ì‚¬ë¬´ì‹¤ì—ì„œ ì „ë‹¬í•˜ëŠ” ì¤‘ìš” ê³µì§€ì‚¬í•­ì„ ë“£ìŠµë‹ˆë‹¤.", role: "all" },
                    { time: "21:20 ì „", title: "í˜ˆì•• ì²´í¬", desc: "ì í˜¸ ì „ê¹Œì§€ <strong>'ì²­í•™ê´€'</strong>ì—ì„œ ë°˜ë“œì‹œ í˜ˆì••ì„ ì¸¡ì •í•˜ê³  ì™„ë£Œí•©ë‹ˆë‹¤.", role: "all" }
                ]
            },
            {
                id: 1,
                title: "ì í˜¸",
                timeRange: "21:20 ~ 22:20",
                description: "ì¸ì› ì ê²€ì„ ë§ˆì¹˜ê³ , ì…ì†Œ ì˜ì‹ì¸ 'ë“œëŠ” ë´‰ì‹¬'ì„ ìœ„í•´ ê²½ê±´í•˜ê²Œ ì¤€ë¹„í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.",
                steps: [
                    { time: "21:20 ê¹Œì§€", title: "ëŒ€ê¸° ì™„ë£Œ", desc: "ëŠ¦ì–´ë„ 21:20ê¹Œì§€ëŠ” ëŒ€ê°•ì „ 1ì¸µì— ë„ì°©í•˜ì—¬ ì í˜¸ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤. <strong>ê°ì ê³µë¶€ ì‹œê°„ì— ë§ê²Œ ì¤„ì„ ì„œë©´ ë©ë‹ˆë‹¤.</strong>", role: "all" },
                    { time: "21:30", title: "ì í˜¸ ì‹œì‘", desc: "ëŒ€ê°•ì „ 1ì¸µì—ì„œ ì „ì²´ ì í˜¸ë¥¼ ì‹¤ì‹œí•©ë‹ˆë‹¤. <br><span class='text-red-600 font-bold'>ì£¼ì˜: ì‹œí•™ì›ê»˜ì„œ í˜¸ëª…í•˜ì‹¤ ë•ŒëŠ” ê³ ê°œë¥¼ ìˆ™ì´ê±°ë‚˜ í—ˆë¦¬ë¥¼ êµ½íˆì§€ ì•Šê³ , ë°”ë¥¸ ìì„¸ ê·¸ëŒ€ë¡œ ê°„ê²°í•˜ê²Œ 'ë„¤'í•˜ê³  ë‹µí•©ë‹ˆë‹¤.</span>", role: "all" }
                ]
            },
            {
                id: 2,
                title: "ë“œëŠ” ë´‰ì‹¬",
                timeRange: "22:20 ~ ì¢…ë£Œ",
                description: "ê³µë¶€ì˜ ì‹œì‘ì„ ì•Œë¦¬ëŠ” ê°€ì¥ ì¤‘ìš”í•œ ì˜ì‹ì…ë‹ˆë‹¤. ë³µì¡í•œ ì´ë™ê³¼ ì˜ˆë²•ì´ ìˆìœ¼ë‹ˆ ì£¼ì˜ ê¹Šê²Œ í™•ì¸í•˜ì„¸ìš”.",
                hasSimulation: true,
                steps: [
                    { time: "22:20 ê¹Œì§€", title: "ì‹œë¦½ (ëŒ€ê¸°)", desc: "1ì—´(íšŒì›), 2ì—´(ì™¸ìˆ˜), 3ì—´(ë‚´ìˆ˜) ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ëŒ€ê¸°í•©ë‹ˆë‹¤. ì¡ë‹´ì„ ê¸ˆí•©ë‹ˆë‹¤.", role: "all" },
                    { time: "22:27", title: "ì†Œì¢… ë° ì´ë™ ì‹œì‘", desc: "ì†Œì¢…ì´ ìš¸ë¦¬ë©´ êµ¬ë ¹ì— ë”°ë¼ ì´ë™í•©ë‹ˆë‹¤.", role: "all" }
                ],
                dropdowns: [
                    { title: "ì…ì¥", content: "<p class='text-stone-500 italic p-2'>ë‚´ìš© ì¶”í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •</p>" },
                    { title: "ë´‰ì‹¬", content: "<p class='text-stone-500 italic p-2'>ë‚´ìš© ì¶”í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •</p>" },
                    { title: "í‡´ì¥", content: "<p class='text-stone-500 italic p-2'>ë‚´ìš© ì¶”í›„ ì—…ë°ì´íŠ¸ ì˜ˆì •</p>" }
                ]
            }
        ];

        // --- State Management ---
        let currentPhaseIdx = 0;
        // Role filter removed, default is 'all'

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderPhase(0);
        });

        // --- Phase Navigation Logic ---
        function setPhase(index) {
            currentPhaseIdx = index;
            
            // Update Buttons
            [0, 1, 2].forEach(i => {
                const btn = document.getElementById(`btn-phase-${i}`);
                if (i === index) {
                    btn.className = "flex-1 w-full text-center py-4 rounded-lg text-base font-bold transition-all duration-200 bg-white shadow-md border-b-4 border-amber-600 text-stone-900 transform scale-[1.02]";
                } else {
                    btn.className = "flex-1 w-full text-center py-4 rounded-lg text-base font-bold text-stone-500 hover:bg-stone-100 hover:text-stone-700 transition-all duration-200";
                }
            });

            renderPhase(index);
        }

        // --- Main Rendering Logic ---
        function renderPhase(index) {
            const phase = phases[index];
            const container = document.getElementById('phase-content');
            
            // Build Base HTML
            let html = `
                <div class="bg-white rounded-xl shadow-lg p-8 border border-stone-100 fade-in">
                    <div class="border-b border-stone-200 pb-4 mb-8">
                        <div class="flex flex-col md:flex-row justify-between md:items-end gap-2">
                            <h2 class="text-3xl font-bold text-stone-800 serif">${phase.title}</h2>
                            <span class="text-amber-600 font-mono font-bold text-xl">${phase.timeRange}</span>
                        </div>
                        <p class="text-stone-600 mt-4 text-xl">${phase.description}</p>
                    </div>

                    <div class="space-y-6">
            `;

            // Render Steps
            phase.steps.forEach(step => {
                const highlightClass = 'border-l-4 border-stone-400'; 
                
                html += `
                    <div class="step-card bg-stone-50 p-6 rounded-lg flex flex-col md:flex-row gap-6 ${highlightClass}">
                        <div class="md:w-36 flex-shrink-0">
                            <span class="inline-block bg-stone-200 text-stone-700 px-4 py-2 rounded-full text-sm font-bold font-mono">
                                ${step.time}
                            </span>
                        </div>
                        <div class="flex-grow">
                            <h4 class="font-bold text-stone-800 text-xl flex items-center">
                                ${step.title}
                            </h4>
                            <p class="text-stone-600 mt-2 text-lg">${step.desc}</p>
                        </div>
                    </div>
                `;
            });

            html += `</div>`; // Close space-y-6 for steps

            // Dropdowns for Phase 3
            if (phase.dropdowns) {
                html += `<div class="mt-10 space-y-4">`;
                phase.dropdowns.forEach(drop => {
                    html += `
                        <details class="bg-stone-50 rounded-lg border border-stone-200 overflow-hidden group">
                            <summary class="cursor-pointer p-6 font-bold text-stone-800 text-lg hover:bg-stone-100 flex justify-between items-center select-none">
                                <span>${drop.title}</span>
                                <span class="text-amber-500 transition-transform duration-300 group-open:rotate-180 text-xl">â–¼</span>
                            </summary>
                            <div class="p-6 border-t border-stone-100 bg-white text-stone-700 leading-relaxed text-lg">
                                ${drop.content}
                            </div>
                        </details>
                    `;
                });
                html += `</div>`;
            }

            // Add Simulation if Phase 3
            if (phase.hasSimulation) {
                html += renderSimulationUI();
            }

            html += `</div>`; // Close main card
            container.innerHTML = html;
        }

        // --- Simulation UI Logic (Phase 3 Special Feature) ---
        function renderSimulationUI() {
            return `
                <div class="mt-12 pt-10 border-t border-stone-200">
                    <h3 class="text-2xl font-bold text-stone-800 serif mb-6">ëŒ€í˜• ë³€í™” ì‹œë®¬ë ˆì´í„° (ì´ 36ëª…)</h3>
                    <p class="text-base text-stone-500 mb-8">
                        <span class="block mb-2"><strong>êµ¬ì„±:</strong> 
                            <span class="inline-block w-4 h-4 bg-yellow-300 rounded-full mr-1 align-middle"></span>íšŒì› (1~12), 
                            <span class="inline-block w-4 h-4 bg-blue-300 rounded-full mr-1 align-middle"></span>ì™¸ìˆ˜ (1~12), 
                            <span class="inline-block w-4 h-4 bg-red-300 rounded-full mr-1 align-middle"></span>ë‚´ìˆ˜ (1~12)
                        </span>
                        <span class="block mb-2"><strong>ì´ˆê¸° ìƒíƒœ:</strong> ê° ì¤„ 12ëª… íš¡ëŒ€ (ê°€ì¥ ë¨¼ì € ì…ì¥í•œ ì‚¬ëŒì´ ì˜¤ë¥¸ìª½ ë)</span>
                    </p>
                    
                    <div class="flex flex-col sm:flex-row justify-center gap-4 mb-8">
                        <button onclick="updateSim('initial')" class="px-6 py-3 bg-stone-200 hover:bg-stone-300 rounded text-base font-bold text-stone-700 w-full sm:w-auto">1. ì´ˆê¸° ì •ë ¬</button>
                        <button onclick="updateSim('final')" class="px-6 py-3 bg-amber-100 hover:bg-amber-200 rounded text-base font-bold text-amber-800 border border-amber-300 w-full sm:w-auto">2. ì¬ì •ë ¬ í›„</button>
                    </div>

                    <div id="sim-container" class="bg-stone-800 p-4 sm:p-8 pr-12 pt-12 rounded-xl mx-auto max-w-3xl relative h-[500px] border-4 border-double border-stone-600 overflow-hidden">
                        
                        <!-- Sinwi (Right Side) -->
                        <div class="absolute right-0 top-0 h-full w-10 bg-stone-700 border-l border-stone-600 flex flex-col items-center justify-center z-20 shadow-lg">
                            <span class="writing-vertical text-amber-400 font-serif font-bold text-lg tracking-[0.5em] drop-shadow-md">ì‹ ìœ„</span>
                        </div>

                        <!-- Sinwi (Top Side) -->
                        <div class="absolute top-0 left-0 w-full h-10 bg-stone-700 border-b border-stone-600 flex items-center justify-center z-20 shadow-lg">
                            <span class="text-amber-400 font-serif font-bold text-lg tracking-[0.5em] drop-shadow-md">ì‹ ìœ„</span>
                        </div>
                        
                        <!-- Nodes generated by JS -->
                        <div id="nodes-area" class="relative w-full h-full"></div>
                    </div>
                </div>
            `;
        }

        // --- Simulation Animation Logic (Updated for 36 People + Rotation) ---
        // 36 people in total. 3 Rows of 12.
        // Row 1: Member (Yellow) 1-12
        // Row 2: Oesu (Blue) 1-12
        // Row 3: Naesu (Red) 1-12
        
        function updateSim(state) {
            const area = document.getElementById('nodes-area');
            if (!area) return; // Guard clause
            
            area.innerHTML = '';
            
            // Define Roles
            const roles = [
                { name: 'member', colorClass: 'bg-yellow-200 text-yellow-900 border-yellow-400' },
                { name: 'oesu', colorClass: 'bg-blue-200 text-blue-900 border-blue-400' },
                { name: 'naesu', colorClass: 'bg-red-200 text-red-900 border-red-400' }
            ];

            // Loop for 3 roles/rows
            roles.forEach((role, rIndex) => {
                // Loop for 12 people per role
                for (let i = 1; i <= 12; i++) {
                    const node = document.createElement('div');
                    // Increased size to w-7 h-7 for better visibility on mobile
                    node.className = `formation-node absolute w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold shadow-md z-10 border-2 ${role.colorClass}`;
                    node.innerText = i;

                    // Positioning Logic
                    // rIndex 0 (Member), 1 (Oesu), 2 (Naesu)
                    // i 1..12 (1 is Rightmost)

                    // Horizontal: 1 is Right (0 index), 12 is Left (11 index)
                    const colIndexFromRight = i - 1; 
                    const horizontalSpacing = 7.5; // %
                    
                    // Initial/Final Horizontal Logic
                    // If Final & Even: Align with Odd (i-1)
                    let effectiveColIndex = colIndexFromRight;
                    if (state === 'final' && i % 2 === 0) {
                        effectiveColIndex = colIndexFromRight - 1; 
                    }
                    
                    // Left % calculation - adjusted to allow space for Sinwi on right and top
                    // Container layout adjusted via padding
                    let left = (90 - (effectiveColIndex * horizontalSpacing)) + '%';

                    // Vertical Logic
                    const rowBaseTop = 10 + (rIndex * 28); // Spacing rows
                    let top = rowBaseTop + '%';

                    if (state === 'final') {
                        // Rotation: Rotate 90deg clockwise so number faces right
                        node.style.transform = 'rotate(90deg)'; 

                        // Even moves down
                        if (i % 2 === 0) {
                            top = (rowBaseTop + 12) + '%';
                        }
                    } else {
                        node.style.transform = 'rotate(0deg)';
                    }

                    node.style.left = left;
                    node.style.top = top;

                    // Visual distinction for movers (Evens)
                    if (i % 2 === 0) {
                        node.style.borderStyle = 'dashed';
                    }

                    area.appendChild(node);
                }
            });
        }

        // Add CSS Animation class
        const styleSheet = document.createElement("style");
        styleSheet.innerText = `
            .fade-in { animation: fadeIn 0.5s ease-in; }
            @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        `;
        document.head.appendChild(styleSheet);

    </script>
</body>
</html>
